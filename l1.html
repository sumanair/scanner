<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Data Decoder</title>
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <div class="container">
        <h1>QR Data Decoder</h1>
        <div id="decodedData"></div>
        <div id="metadataContent"></div>
        <div id="jsonToggle" class="json-toggle">Show Raw JSON</div>
        <div id="jsonContent" class="json-content"></div>
    </div>

    <script>
        // Your JavaScript code
        function renderJsonAsTable(jsonData) {
            let html = '<table>';
            Object.entries(jsonData).forEach(([key, value]) => {
                html += `<tr><th>${key}</th><td>${typeof value === 'object' ? renderJsonAsTable(value) : value}</td></tr>`;
            });
            html += '</table>';
            return html;
        }

        const urlParams = new URLSearchParams(window.location.search);
        let base64Data = urlParams.get('data');

        if (base64Data) {
            try {
                base64Data = base64Data.replace(/-/g, '+').replace(/_/g, '/');
                const decodedString = decodeURIComponent(atob(base64Data));
                const decodedJson = JSON.parse(decodedString);

                document.getElementById('decodedData').innerHTML = renderJsonAsTable(decodedJson.data || decodedJson);
                document.getElementById('jsonContent').innerText = JSON.stringify(decodedJson, null, 2);

                document.getElementById('jsonToggle').addEventListener('click', () => {
                    const jsonContent = document.getElementById('jsonContent');
                    jsonContent.style.display = jsonContent.style.display === 'none' ? 'block' : 'none';
                });
            } catch (error) {
                console.error("Error decoding Base64 or parsing JSON:", error);
            }
        } else {
            document.getElementById('decodedData').innerText = 'No data found.';
        }
    </script>
</body>
</html>
